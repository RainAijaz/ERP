const { parseCookies, setCookie } = require("../utils/cookies");

const translations = {
  en: {
    // --- USERS MODULE ---
    add_user: "Add User",
    edit_user: "Edit User",
    manage_system_access: "Manage system access",
    back_to_users: "Back to users",
    leave_blank_keep: "(Set new password (leave blank to keep current))",
    select_role: "Select Role",
    assigned_branches: "Assigned Branches",
    branch_access_hint: "User can only access data for assigned branches.",
    is_active_user: "Is Active User",
    role: "Role",
    email: "Email",
    selected: "Selected",

    // --- ROLES MODULE ---
    add_role: "Add Role",
    manage_user_roles: "Manage user roles",
    back_to_roles: "Back to roles",
    role_name: "Role Name",
    description: "Description",

    // --- PERMISSIONS MODULE ---
    configure_access_rights: "Configure access rights",
    user_overrides: "User Overrides",
    select_user: "Select User",
    module: "Module",
    screen: "Screen",
    navigate: "Navigate",
    voucher: "Voucher",
    report: "Report",
    view: "View",
    create: "Create",
    delete: "Delete",
    approve: "Approve",
    post: "Post",
    approval_settings: "Approval Settings",
    approval_rules: "Approval Rules",
    requires_approval: "Requires Approval",
    approval_submitted: "Approval request submitted. Changes will apply after approval.",
    approval_approved: "Approval request approved.",
    approval_rejected: "Approval request rejected.",
    approval_request_not_found: "Approval request not found or already decided.",
    approval_apply_failed: "Approval applied, but change could not be executed.",
    permission_denied: "Permission denied.",
    error_invalid_id: "Invalid ID.",
    error_not_found: "Record not found.",
    override_mode_active: "Override mode active",
    user_overrides_hint: "User-only changes apply to this user only (role permissions still apply unless overridden).",
    role_changes_global_hint: "Role permissions apply to all users assigned to this role.",
    save_permissions: "Save Permissions",
    search_permissions: "Search permissions...",
    expand_all: "Expand all",
    collapse_all: "Collapse all",
    scope_missing: "Scope missing in registry",
    select_target_to_configure: "Select a target to configure.",
    select_user_to_configure: "Select a user to configure permissions.",
    select_role_to_configure: "Select a role to configure permissions.",
    choose_role_above: "Choose a role above to view and update permissions.",
    choose_role_or_user_above: "Choose a role or user above to configure permissions.",
    back_to_branches: "Back to branches",
    edit_branch: "Edit Branch",
    branch_code: "Branch Code",
    unique_identifier_hint: "Short unique code for this branch (e.g. LHR01)",
    branch_name: "Branch Name",
    city: "City",
    is_active: "Is Active",
    active_branch_hint: "Inactive branches are hidden from selection and cannot be used for new transactions.",
    save_changes: "Save Changes",
    manage_company_locations: "Manage branch locations and availability",
    add_new_branch: "Add Branch",
    code: "Code",
    no_records_found: "No records found.",
    no_navigate_access_message: "Records are hidden because you don’t have navigation access.",
    // --- BRAND & AUTH ---
    brand: "CHAND EVA",
    dashboard: "Dashboard",
    welcome: "Welcome back. Select a module from the navigation to begin.",
    branch: "Branch",
    signed_in_as: "Signed in as",
    logout: "Logout",
    sign_in: "Sign in",
    use_credentials: "Use your ERP credentials to continue.",
    username: "Username",
    password: "Password",
    login: "Login",
    incorrect_credentials: "Incorrect username or password. Try again.",
    user_inactive: "User is inactive. Contact admin.",
    login_failed: "Login failed. Please try again.",

    // --- MODULES ---
    administration: "Administration",
    setup: "Setup",
    branches: "Branches",
    users: "Users",
    roles: "Roles",
    permissions: "Permissions",
    approvals: "Approvals", // Renamed from "Pending Approvals" to be generic
    audit_logs: "Activity Log",
    master_data: "Master Data",
    accounts_parties: "Accounts & Parties",
    accounts: "Accounts",
    parties: "Parties",
    products: "Products",
    basic_information: "Basic Information",
    hr_payroll: "HR & Payroll",
    financial: "Financial",
    purchase: "Purchase",
    production: "Production",
    inventory: "Inventory",
    outward_returnable: "Outward & Returnable",
    sales: "Sales",

    // --- COMMON LABELS ---
    add: "Add",
    list: "List",
    show: "Show",
    rows: "Rows",
    status: "Status",
    search: "Search",
    all: "All",
    none: "NONE",
    active: "Active",
    inactive: "Inactive",
    sr_no: "Sr.No",
    actions: "Actions",
    no_entries: "No entries yet.",
    yes: "Yes",
    no: "No",
    edit: "Edit",
    activate: "Activate",
    deactivate: "Deactivate",
    permanent_delete: "Permanent Delete",
    confirm: "Confirm",
    are_you_sure: "Are you sure?",
    continue: "Continue",
    cancel: "Cancel",
    save: "Save",
    audit: "Audit",
    created: "Created",
    updated: "Updated",
    enter_details_save: "Enter details and save.",
    showing: "Showing",
    to: "to",
    of: "of",
    entries: "entries",
    download: "Download",
    print: "Print",
    filters: "Filters",
    apply: "Apply",
    clear: "Clear",
    include: "Include",
    exclude: "Exclude",
    select: "Select",
    prev: "Prev",
    next: "Next",
    new: "New",
    back_to_list: "Back to list",
    date: "Date",
    summary: "Summary",
    saving: "Saving...",
    load_failed: "Failed to load content.",
    error_saving: "Error saving.",
    error_generic: "Error.",
    unexpected_response: "Unexpected response",
    network_error: "Network error. Please try again.",

    // --- SKU & MATRIX SPECIFIC ---
    skus: "SKUs",
    skus_description: "Maintain SKU variants and pricing.",
    check_availability: "Check Availability",
    no_new_combinations: "All selected combinations already exist.",
    new_combinations_found: "new combinations found.",
    sale_rate: "Sale Rate",
    sku_code: "SKU Code",
    barcode: "Barcode",
    size: "Size",
    color: "Color",
    grade: "Grade",
    packing_type: "Packing Type",
    article: "Article",
    rates: "Rates",

    // --- APPROVALS & STATUSES ---
    pending: "Pending",
    approved: "Approved",
    rejected: "Rejected",
    unknown: "Unknown",
    requester: "Requester",
    old_rate: "Old Rate",
    new_rate: "New Rate",
    approve: "Approve",
    reject: "Reject",
    rate_change_submitted: "Rate change submitted for approval.",
    request_approved: "Request approved.",
    request_rejected: "Request rejected.",

    // --- ERRORS & MESSAGES ---
    saved_successfully: "Saved successfully.",
    error_required_fields: "Please fill all required fields.",
    error_unable_save: "Unable to save. Check for duplicate values or invalid data.",
    error_immutable_field: "Cannot edit physical variant properties. Create a new SKU instead.",
    error_update_status: "Unable to update status. This item may be in use.",
    error_delete: "Unable to delete. This item may be in use.",
    error_duplicate_code: "Code already exists.",
    error_duplicate_name: "Name already exists.",

    // --- EXISTING KEYS (Preserved) ---
    units: "Units",
    groups: "Groups",
    party_groups: "Party Groups",
    account_groups: "Account Groups",
    account_type: "Account Type",
    account_group: "Account Group",
    account_code: "Account Code",
    account_name: "Account Name",
    lock_posting: "Lock Posting",
    party_type: "Party Type",
    party_group: "Party Group",
    party_code: "Party Code",
    party_name: "Party Name",
    address: "Address",
    phone_primary: "Phone (Primary)",
    phone_secondary: "Phone (Secondary)",
    phone_1: "Phone 1",
    phone_2: "Phone 2",
    city: "City",
    customer: "Customer",
    supplier: "Supplier",
    credit_allowed: "Credit Allowed",
    credit_limit: "Credit Limit",
    departments: "Departments",
    product_groups: "Product Groups",
    product_subgroups: "Product Sub-Groups",
    product_types: "Product Types",
    sizes: "Sizes",
    colors: "Colors",
    grades: "Grades",
    packing_types: "Packing Types",
    cities: "Cities",
    uom_conversions: "UOM Conversions",
    finished: "Finished",
    semi_finished: "Semi-Finished",
    raw_materials: "Raw Materials",
    semi_finished_goods: "Semi-Finished Goods",
    finished_goods: "Finished Goods",
    article_name: "Article Name",
    group: "Group",
    sub_group: "Sub Group",
    base_unit: "Base Unit",
    category: "Category",
    uses_sfg: "Uses SFG",
    sfg_part: "SFG Part",
    sfg_part_type: "SFG Part Type",
    upper: "Upper",
    step: "Step",
    color_rates: "Color Rates",
    avg_purchase_rate: "Avg Purchase Rate",
    min_stock: "Min Stock",
    sizes_label: "Sizes",
    usage: "Usage In",
    expanded: "Expanded",
    one_color: "One Color",
    one_size: "One Size",
    only: "Only",
    variant_id: "Variant ID",
    purchase_rate: "Purchase Rate",
    sizes_help: "Select one or more sizes used by this semi-finished item.",
    finished_description: "Maintain finished articles, categories, and SFG usage flags.",
    semi_finished_description: "Maintain semi-finished items and their applicable sizes.",
    raw_materials_description: "Maintain raw materials with per-color purchase rates.",
    bom: "BOM",
    bom_list: "BOM List",
    bom_versions: "Versions",
    bom_approval: "Approval",
    employees: "Employees",
    sales_commission: "Sales Commission",
    allowances: "Allowances",
    labours: "Labours",
    labour_rates: "Labour Rates",
    vouchers: "Vouchers",
    cash_voucher: "Cash Voucher",
    bank_voucher: "Bank Voucher",
    journal_voucher: "Journal Voucher",
    reports: "Reports",
    financial_reports: "Financial Reports",
    purchase_invoice: "Purchase Invoice",
    purchase_order: "Purchase Order",
    purchase_return: "Purchase Return",
    purchase_reports: "Purchase Report",
    abnormal_loss: "Abnormal Loss",
    production_reports: "Production Reports",
    inventory_voucher: "Inventory Voucher",
    stock_count: "Stock Count",
    stock_transfer: "Stock Transfer",
    inventory_reports: "Inventory Reports",
    returnables: "Returnables",
    returnable_reports: "Returnable Reports",
    sales_voucher: "Sales Voucher",
    sales_order: "Sales Order",
    sales_reports: "Sales Reports",
    auto_translate: "Auto Translate",
    translate_to_urdu: "Translate to Urdu",
    tooltip_account_type: "Main accounting classification (Asset, Liability, Equity, Revenue, Expense).",
    tooltip_code: "Short code used in reports and filtering.",
    tooltip_contra: "Offsets the balance of its parent group.",
    help_unit_code: "Short unique key used by the system (e.g., PCS, KG).",
    help_unit_name: "Descriptive name shown on reports and documents.",
    language: "Language",
    english: "English",
    urdu: "Urdu",
    pair_rate: "Pair Rate",
    dozen_rate: "Dozen Rate",
    variants: "Variants",
    add_new_combinations: "Add Variants",
    variants_sent_approval: "Variants will be added once approved.",
  },
  ur: {
    // --- USERS MODULE ---
    add_user: "نیا صارف شامل کریں",
    edit_user: "صارف میں ترمیم کریں",
    manage_system_access: "سسٹم تک رسائی کا انتظام کریں",
    back_to_users: "صارفین پر واپس",
    leave_blank_keep: "(نیا پاس ورڈ دیں (موجودہ برقرار رکھنے کے لیے خالی چھوڑیں))",
    select_role: "رول منتخب کریں",
    assigned_branches: "تفویض شدہ برانچز",
    branch_access_hint: "صارف صرف تفویض شدہ برانچز کا ڈیٹا دیکھ سکتا ہے۔",
    is_active_user: "فعال صارف ہے",
    role: "رول",
    email: "ای میل",
    selected: "منتخب",

    // --- ROLES MODULE ---
    add_role: "نیا رول شامل کریں",
    manage_user_roles: "صارف رولز کا انتظام کریں",
    back_to_roles: "رولز پر واپس",
    role_name: "رول کا نام",
    description: "تفصیل",

    // --- PERMISSIONS MODULE ---
    configure_access_rights: "رسائی کے حقوق ترتیب دیں",
    user_overrides: "صارف اووررائیڈز",
    select_user: "صارف منتخب کریں",
    module: "ماڈیول",
    screen: "اسکرین",
    navigate: "نیویگیٹ",
    voucher: "ووچر",
    report: "رپورٹ",
    view: "دیکھیں",
    create: "بنائیں",
    delete: "حذف کریں",
    approve: "منظور کریں",
    post: "پوسٹ کریں",
    approval_settings: "منظوری کی ترتیبات",
    approval_rules: "منظوری کے قواعد",
    requires_approval: "منظوری درکار",
    approval_submitted: "منظوری کی درخواست جمع ہو گئی ہے۔ منظوری کے بعد تبدیلی لاگو ہوگی۔",
    approval_approved: "منظوری کی درخواست منظور ہو گئی ہے۔",
    approval_rejected: "منظوری کی درخواست مسترد کر دی گئی ہے۔",
    approval_request_not_found: "منظوری کی درخواست موجود نہیں یا پہلے ہی فیصلہ ہو چکا ہے۔",
    approval_apply_failed: "منظوری ہوگئی لیکن تبدیلی نافذ نہیں ہو سکی۔",
    permission_denied: "اجازت نہیں ہے۔",
    error_invalid_id: "غلط شناخت۔",
    error_not_found: "ریکارڈ موجود نہیں۔",
    override_mode_active: "اووررائیڈ موڈ فعال ہے",
    user_overrides_hint: "صرف اسی صارف پر لاگو ہوں گی (رول اجازتیں اووررائیڈ ہونے تک برقرار رہتی ہیں)۔",
    role_changes_global_hint: "رول کی اجازتیں اس رول کے تمام صارفین پر لاگو ہوتی ہیں۔",
    save_permissions: "اجازتیں محفوظ کریں",
    search_permissions: "اجازتیں تلاش کریں...",
    expand_all: "سب کھولیں",
    collapse_all: "سب بند کریں",
    scope_missing: "سکوپ رجسٹری میں موجود نہیں",
    select_target_to_configure: "ترتیب دینے کے لیے ہدف منتخب کریں۔",
    select_user_to_configure: "اجازتوں کے لیے صارف منتخب کریں۔",
    select_role_to_configure: "اجازتوں کے لیے رول منتخب کریں۔",
    choose_role_above: "اوپر سے رول منتخب کریں تاکہ اجازتیں دیکھ اور اپڈیٹ کی جا سکیں۔",
    choose_role_or_user_above: "اجازتیں ترتیب دینے کے لیے اوپر سے رول یا صارف منتخب کریں۔",
    back_to_branches: "برانچز پر واپس",
    edit_branch: "برانچ میں ترمیم کریں",
    branch_code: "برانچ کوڈ",
    unique_identifier_hint: "اس برانچ کے لیے مختصر منفرد کوڈ (مثلاً LHR01)",
    branch_name: "برانچ نام",
    city: "شہر",
    is_active: "فعال ہے",
    active_branch_hint: "غیر فعال برانچز انتخاب میں نہیں آتیں اور ان پر نئے لین دین نہیں ہو سکتے۔",
    save_changes: "تبدیلیاں محفوظ کریں",
    manage_company_locations: "برانچز کے مقامات اور دستیابی کا انتظام کریں",
    add_new_branch: "برانچ شامل کریں",
    code: "کوڈ",
    no_records_found: "کوئی ریکارڈ نہیں ملا۔",
    no_navigate_access_message: "ریکارڈز چھپائے گئے ہیں کیونکہ آپ کے پاس نیویگیٹ اجازت نہیں ہے۔",
    // --- BRAND & AUTH ---
    brand: "چاند ایوا",
    dashboard: "ڈیش بورڈ",
    welcome: "خوش آمدید۔ شروع کرنے کے لئے نیویگیشن سے ماڈیول منتخب کریں۔",
    branch: "برانچ",
    signed_in_as: "بطور داخل",
    logout: "لاگ آؤٹ",
    sign_in: "سائن اِن",
    use_credentials: "جاری رکھنے کے لیے اپنی ERP اسناد استعمال کریں۔",
    username: "صارف نام",
    password: "پاس ورڈ",
    login: "لاگ اِن",
    incorrect_credentials: "غلط صارف نام یا پاس ورڈ۔ دوبارہ کوشش کریں۔",
    user_inactive: "صارف غیر فعال ہے۔ ایڈمن سے رابطہ کریں۔",
    login_failed: "لاگ اِن ناکام۔ دوبارہ کوشش کریں۔",

    // --- MODULES ---
    administration: "انتظامیہ",
    setup: "سیٹ اپ",
    branches: "برانچز",
    users: "صارفین",
    roles: "رولز",
    permissions: "اجازتیں",
    approvals: "منظوری", // Changed
    audit_logs: "سرگرمی لاگ",
    master_data: "ماسٹر ڈیٹا",
    accounts_parties: "اکاؤنٹس اور پارٹیز",
    accounts: "اکاؤنٹس",
    parties: "پارٹیز",
    products: "مصنوعات",
    basic_information: "بنیادی معلومات",
    hr_payroll: "ایچ آر اور پے رول",
    financial: "مالیاتی",
    purchase: "خریداری",
    production: "پروڈکشن",
    inventory: "انوینٹری",
    outward_returnable: "آؤٹ ورڈ اور ریٹرنیبل",
    sales: "سیلز",

    // --- COMMON LABELS ---
    add: "شامل کریں",
    list: "فہرست",
    show: "دکھائیں",
    rows: "قطاریں",
    status: "حالت",
    search: "تلاش",
    all: "سب",
    none: "کوئی نہیں",
    active: "فعال",
    inactive: "غیر فعال",
    sr_no: "سیریل نمبر",
    actions: "عمل",
    no_entries: "کوئی اندراج نہیں۔",
    yes: "ہاں",
    no: "نہیں",
    edit: "ترمیم",
    activate: "فعال کریں",
    deactivate: "غیر فعال کریں",
    permanent_delete: "مستقل حذف",
    confirm: "تصدیق",
    are_you_sure: "کیا آپ کو یقین ہے؟",
    continue: "جاری رکھیں",
    cancel: "منسوخ",
    save: "محفوظ کریں",
    audit: "آڈٹ",
    created: "تخلیق",
    updated: "اپ ڈیٹ",
    enter_details_save: "تفصیلات درج کریں اور محفوظ کریں۔",
    showing: "دکھا رہا ہے",
    to: "تا",
    of: "میں سے",
    entries: "اندراجات",
    download: "ڈاؤن لوڈ",
    print: "پرنٹ",
    filters: "فلٹرز",
    apply: "لاگو کریں",
    clear: "صاف کریں",
    include: "شامل کریں",
    exclude: "خارج کریں",
    select: "منتخب کریں",
    prev: "پچھلا",
    next: "اگلا",
    new: "نیا",
    back_to_list: "فہرست پر واپس",
    date: "تاریخ",
    summary: "خلاصہ",
    saving: "محفوظ ہو رہا ہے...",
    load_failed: "مواد لوڈ نہیں ہو سکا۔",
    error_saving: "محفوظ کرنے میں خرابی۔",
    error_generic: "خرابی۔",
    unexpected_response: "غیر متوقع جواب",
    network_error: "نیٹ ورک خرابی۔ دوبارہ کوشش کریں۔",

    // --- SKU & MATRIX SPECIFIC ---
    skus: "ایس کے یو",
    skus_description: "SKU ویریئنٹس اور قیمتوں کا انتظام۔",
    check_availability: "دستیابی چیک کریں",
    no_new_combinations: "تمام منتخب کردہ مجموعے پہلے سے موجود ہیں۔",
    new_combinations_found: "نئے مجموعے مل گئے۔",
    sale_rate: "سیل ریٹ",
    sku_code: "SKU کوڈ",
    barcode: "بارکوڈ",
    size: "سائز",
    color: "رنگ",
    grade: "گریڈ",
    packing_type: "پیکنگ ٹائپ",
    article: "آرٹیکل",
    rates: "ریٹس",

    // --- APPROVALS & STATUSES ---
    pending: "زیر التواء",
    approved: "منظور شدہ",
    rejected: "مسترد شدہ",
    unknown: "نامعلوم",
    requester: "درخواست کنندہ",
    old_rate: "پرانا ریٹ",
    new_rate: "نیا ریٹ",
    approve: "منظور کریں",
    reject: "مسترد کریں",
    rate_change_submitted: "ریٹ میں تبدیلی منظوری کے لیے جمع کر دی گئی ہے۔",
    request_approved: "درخواست منظور ہو گئی۔",
    request_rejected: "درخواست مسترد ہو گئی۔",
    pair_rate: "جوڑی ریٹ",
    dozen_rate: "درجن ریٹ",
    variants: "اقسام",
    add_new_combinations: "نئی اقسام شامل کریں",
    variants_sent_approval: "اقسام منظوری کے بعد شامل کی جائیں گی۔",

    // --- ERRORS & MESSAGES ---
    saved_successfully: "کامیابی سے محفوظ ہو گیا۔",
    error_required_fields: "تمام ضروری خانے پُر کریں۔",
    error_unable_save: "محفوظ نہیں ہو سکا۔ ڈپلیکیٹ یا غلط ڈیٹا چیک کریں۔",
    error_immutable_field: "جسمانی خصوصیات تبدیل نہیں کی جا سکتیں۔ اس کے بجائے نیا SKU بنائیں۔",
    error_update_status: "اس کی حالت تبدیل نہیں ہو سکی۔ یہ آئٹم استعمال میں ہو سکتا ہے۔",
    error_delete: "حذف نہیں ہو سکا۔ یہ آئٹم استعمال میں ہو سکتا ہے۔",
    error_duplicate_code: "کوڈ پہلے سے موجود ہے۔",
    error_duplicate_name: "نام پہلے سے موجود ہے۔",

    // --- EXISTING KEYS (Preserved) ---
    units: "یونٹس",
    groups: "گروپس",
    party_groups: "پارٹی گروپس",
    account_groups: "اکاؤنٹ گروپس",
    account_type: "اکاؤنٹ ٹائپ",
    account_group: "اکاؤنٹ گروپ",
    account_code: "اکاؤنٹ کوڈ",
    account_name: "اکاؤنٹ نام",
    lock_posting: "پوسٹنگ لاک",
    party_type: "پارٹی ٹائپ",
    party_group: "پارٹی گروپ",
    party_code: "پارٹی کوڈ",
    party_name: "پارٹی نام",
    address: "پتہ",
    phone_1: "فون 1",
    phone_2: "فون 2",
    city: "شہر",
    customer: "کسٹمر",
    supplier: "سپلائر",
    credit_allowed: "ادھار کی اجازت",
    credit_limit: "ادھار حد",
    departments: "محکمے",
    product_groups: "پروڈکٹ گروپس",
    product_subgroups: "پروڈکٹ سب گروپ",
    product_types: "پروڈکٹ ٹائپس",
    sizes: "سائزز",
    colors: "رنگ",
    grades: "گریڈز",
    packing_types: "پیکنگ ٹائپس",
    cities: "شہر",
    uom_conversions: "یو او ایم کنورژنز",
    finished: "فنشڈ",
    semi_finished: "سیمی فنشڈ",
    raw_materials: "خام مال",
    semi_finished_goods: "نیم تیار مال",
    finished_goods: "تیار شدہ مال",
    article_name: "آرٹیکل نام",
    group: "گروپ",
    sub_group: "ذیلی گروپ",
    base_unit: "بنیادی یونٹ",
    category: "قسم",
    uses_sfg: "سیمی فِنشڈ استعمال",
    sfg_part: "SFG حصہ",
    sfg_part_type: "SFG حصہ کی قسم",
    upper: "اپر",
    step: "اسٹیپ",
    color_rates: "رنگ ریٹس",
    avg_purchase_rate: "اوسط خریداری ریٹ",
    min_stock: "کم از کم اسٹاک",
    sizes_label: "سائز",
    usage: "استعمال",
    expanded: "تفصیل",
    one_color: "ایک رنگ",
    one_size: "ایک سائز",
    only: "صرف",
    variant_id: "ویریئنٹ آئی ڈی",
    purchase_rate: "خریداری ریٹ",
    sizes_help: "اس سیمی فِنشڈ آئٹم کے لیے ایک یا زیادہ سائز منتخب کریں۔",
    finished_description: "فنشڈ آرٹیکلز، کیٹیگریز، اور SFG استعمال کی سیٹنگز۔",
    semi_finished_description: "سیمی فِنشڈ آئٹمز اور متعلقہ سائزز کا انتظام۔",
    raw_materials_description: "خام مال کے لیے رنگ وار خریداری ریٹس کے ساتھ اندراج۔",
    bom: "بی او ایم",
    bom_list: "بی او ایم فہرست",
    bom_versions: "ورژنز",
    bom_approval: "منظوری",
    employees: "ملازمین",
    sales_commission: "سیلز کمیشن",
    allowances: "الاؤنسز",
    labours: "لیبرز",
    labour_rates: "لیبر ریٹس",
    vouchers: "ووچرز",
    cash_voucher: "کیش ووچر",
    bank_voucher: "بینک ووچر",
    journal_voucher: "جرنل ووچر",
    reports: "رپورٹس",
    financial_reports: "مالیاتی رپورٹس",
    purchase_invoice: "خریداری انوائس",
    purchase_order: "خریداری آرڈر",
    purchase_return: "خریداری ریٹرن",
    purchase_reports: "خریداری رپورٹس",
    abnormal_loss: "غیر معمولی نقصان",
    production_reports: "پروڈکشن رپورٹس",
    inventory_voucher: "انوینٹری ووچر",
    stock_count: "اسٹاک کاؤنٹ",
    stock_transfer: "اسٹاک ٹرانسفر",
    inventory_reports: "انوینٹری رپورٹس",
    returnables: "ریٹرنیبلز",
    returnable_reports: "ریٹرنیبل رپورٹس",
    sales_voucher: "سیلز ووچر",
    sales_order: "سیلز آرڈر",
    sales_reports: "سیلز رپورٹس",
    tooltip_account_type: "بنیادی اکاؤنٹنگ درجہ بندی (اثاثہ، ذمہ داری، سرمایہ، آمدنی، خرچ)۔",
    tooltip_code: "رپورٹس اور فلٹرنگ کے لیے مختصر کوڈ۔",
    tooltip_contra: "اپنے والد گروپ کے بیلنس کو آف سیٹ کرتا ہے۔",
    help_unit_code: "سسٹم میں استعمال ہونے والا مختصر منفرد کوڈ (مثلاً PCS, KG).",
    help_unit_name: "رپورٹس اور دستاویزات میں دکھایا جانے والا وضاحتی نام۔",
    language: "زبان",
    english: "انگریزی",
    urdu: "اردو",
  },
};

module.exports = (req, res, next) => {
  const cookies = parseCookies(req);
  const requested = (req.query && req.query.lang) || cookies.lang || (req.headers["accept-language"] || "").split(",")[0];
  const normalized = (requested || "en").toLowerCase();
  const locale = normalized.startsWith("ur") ? "ur" : "en";

  if (req.query && req.query.lang) {
    setCookie(res, "lang", locale, {
      path: "/",
      sameSite: "Lax",
      maxAge: 60 * 60 * 24 * 365,
    });
  }

  req.locale = locale;
  res.locals.locale = locale;
  res.locals.t = (key) => translations[locale][key] || translations.en[key] || key;
  next();
};
