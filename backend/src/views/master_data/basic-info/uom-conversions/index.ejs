<div class="mx-auto w-full max-w-7xl space-y-6">
  <section class="rounded-3xl border border-slate-200 bg-white/95 p-6 shadow-lg">
    <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
      <div class="space-y-1">
        <h1 class="text-2xl font-display text-ink"><%= t("uom_conversions") %></h1>
        <p class="text-sm text-muted">Define how one unit converts into another (e.g., 1 BOX = 10 PCS).</p>
      </div>
      <div class="flex flex-wrap gap-2">
        <% const canDownload = can('SCREEN', 'master_data.basic_info.uom_conversions', 'print'); %>
        <% if (canDownload) { %>
          <button class="rounded-full border border-slate-200 bg-white px-4 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-slate-600 transition hover:border-slate-300 hover:text-slate-800" type="button" data-download-button>
            <%= t("download") %>
          </button>
          <button class="rounded-full border border-slate-200 bg-white px-4 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-slate-600 transition hover:border-slate-300 hover:text-slate-800" type="button" data-print-button>
            <%= t("print") %>
          </button>
        <% } %>
        <button class="rounded-full bg-slate-900 px-4 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-white shadow-sm transition hover:bg-slate-800" type="button" data-modal-open>
          Add Conversion
        </button>
      </div>
    </div>
  </section>

  <%- include("../../../base/partials/error-banner", { error, modalOpen }) %>

  <%# UOM conversions list + export/print area. %>
  <section class="rounded-2xl border border-slate-200 bg-white/95 shadow-md" data-print-area>
    <% const canEdit = can('SCREEN', 'master_data.basic_info.uom_conversions', 'edit'); %>
    <% const canDelete = can('SCREEN', 'master_data.basic_info.uom_conversions', 'delete'); %>
    <% const canHardDelete = can('SCREEN', 'master_data.basic_info.uom_conversions', 'hard_delete'); %>
    <div class="px-5 pt-4 text-center text-xl font-display font-semibold uppercase tracking-[0.35em] text-slate-900" data-print-header>
      <%= t("brand") %>
    </div>
    <div class="flex flex-col gap-3 border-b border-slate-200 px-5 py-4 sm:flex-row sm:items-center sm:justify-between">
      <div class="text-sm font-semibold text-slate-700"><%= t("list") %> <%= t("uom_conversions") %></div>
      <%- include("../../../base/partials/table-controls", { t, showStatus: false }) %>
    </div>
    <div class="overflow-x-auto">
      <table class="min-w-full text-sm" data-table>
        <thead class="bg-slate-50 text-xs font-semibold uppercase tracking-[0.1em] text-slate-500">
          <% const displayColumns = [
            { key: "id", labelRaw: "ID", sortType: "number" },
            { key: "from", labelRaw: "From UOM" },
            { key: "to", labelRaw: "To UOM" },
            { key: "factor", labelRaw: "Factor", sortType: "number" }
          ]; %>
          <%- include("../../../base/partials/table-header", { t, displayColumns, columnTooltips: {}, sortStartIndex: 1 }) %>
        </thead>
        <tbody class="divide-y divide-slate-100" data-table-body>
          <% if (!rows || rows.length === 0) { %>
            <%- include("../../../base/partials/table-empty", { t, colspan: displayColumns.length + 2 }) %>
          <% } else { %>
            <% rows.forEach(function(row, idx) { %>
              <tr
                class="hover:bg-amber-50/40"
                data-row
                data-from="<%= row.from_uom_id %>"
                data-to="<%= row.to_uom_id %>"
                data-created-by="<%= row.created_by_name || "" %>"
                data-created-at="<%= row.created_at ? new Date(row.created_at).toISOString().slice(0, 10) : "" %>"
              >
                <td class="px-4 py-3 text-slate-700"><%= idx + 1 %></td>
                <td class="px-4 py-3 text-slate-700"><%= row.id %></td>
                <td class="px-4 py-3 text-slate-700"><%= row.from_code %> &mdash; <%= row.from_name %></td>
                <td class="px-4 py-3 text-slate-700"><%= row.to_code %> &mdash; <%= row.to_name %></td>
                <td class="px-4 py-3 text-slate-700"><%= row.factor %></td>
                <td class="px-4 py-3">
                  <%- include("../../../base/partials/table-actions", { t, row, basePath, editFields: ["from_uom_id", "to_uom_id", "factor"], withMenu: false, canEdit, canDelete, canHardDelete }) %>
                </td>
              </tr>
            <% }) %>
          <% } %>
        </tbody>
      </table>
    </div>
    <%- include("../../../base/partials/table-footer", { t }) %>
  </section>
</div>

<%- include("../../../base/partials/modal-shell", {
  t,
  modalOpen,
  modalMode,
  modalTitle: t("add") + " " + t("uom_conversions"),
  modalDescription: "Define the factor between two units.",
  formAction: basePath,
  formClass: "space-y-5 px-6 py-5",
  modalContainerClass: "w-full max-w-lg rounded-2xl border border-slate-200 bg-white shadow-xl",
  modalHeaderClass: "flex items-center justify-between border-b border-slate-200 px-6 py-4",
  modalError: modalOpen ? error : null,
  modalValues: modalOpen ? values : null,
  csrfToken,
  bodyPartial: "../../master_data/basic-info/uom-conversions/form-fields.ejs"
}) %>

<%- include("../../../base/partials/confirm-modal", { t, csrfToken }) %>

<%- include("../../../base/partials/basic-info-utils", { t, page: { titleKey: "uom_conversions" }, basePath, modalOpen, modalMode }) %>

